package com.matera.service;

import jakarta.enterprise.context.ApplicationScoped;
import jakarta.inject.Inject;
import java.io.File;
import java.util.ArrayList;
import java.util.List;
import java.util.Scanner;
import java.util.Set;

@ApplicationScoped
public class AnalyserService {
    @Inject
    private ConfigValues configValues;

    @Inject
    private Extractor extractor;

    public Set<String> scan() throws Exception{
        File file = new File(configValues.getRootPath() + configValues.getVulnerabilityFile());
        List<String> vulnerabilities = new ArrayList<>();

        try(Scanner scanFile = new Scanner(file)){
            while (scanFile.hasNext()) {
                vulnerabilities.add(scanFile.next());
            }
        }

        return extractor.extract(vulnerabilities);
    }
}